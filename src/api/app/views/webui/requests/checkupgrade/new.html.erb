<% @pagetitle = "Check upgrade for #{@package}" %>
<% @state = @packageCheckUpgrade.state %>
<div class="card">
  <div class="card-body">
    <div class="row">
      <div class="col-12">
        <h3>
          <%= @pagetitle %>
          ouput = <%= @packageCheckUpgrade.output %>

        </h3>
      </div>
      <div class="col-12 col-md-9 col-lg-6">
        <%= form_for(:packageCheckUpgrade, remote: true, url: project_package_checkupgrade_index_path(@project, @package)) do |f| %>

          <!--FIXME test -->
          <%= f.hidden_field(:package_id, value: @package.id) %>
          <%= f.hidden_field(:state) %>

          <div class="form-group">
            <%= f.label("Url") %>
            <abbr class="text-danger" title="required">*</abbr>
            <%= f.text_field(:urlsrc, size: 80, required: true, class: 'form-control', placeholder: 'Enter the url', autofocus: true) %>
          </div>
          <div class="form-group">
            <%= f.label("Regex url") %>
            <abbr class="text-danger" title="required">*</abbr>
            <%= f.text_field(:regexurl, size: 80, required: true, class: 'form-control', placeholder: 'Enter the regular expression for the url') %>
          </div>

          <div class="form-group">
            <%= f.label("Regex Version") %>
            <abbr class="text-danger" title="required">*</abbr>
            <%= f.text_field(:regexver, size: 80, required: true, class: 'form-control', placeholder: 'Enter the regular expression for the version') %>
          </div>

          <div class="form-group">
            <%= f.label("Current version") %>
            <abbr class="text-danger" title="required">*</abbr>
            <%= f.text_field(:currentver, size: 80, required: true, class: 'form-control', placeholder: 'Enter the version') %>
          </div>

          <div class="form-group">
            <%= f.label("Separator") %>
            <abbr class="text-danger" title="required">*</abbr>
            <%= f.text_field(:separator, maxlength: 1, required: true, size: 10, class: 'form-control', placeholder: 'Enter the separator') %>
          </div>

          <div class="form-group">
            <%= f.submit('Run check', class: 'btn btn-primary px-4') %>
          </div>
          <div class="form-group">
            <%= f.label("Output") %>
            <%= f.text_area(:output, id: "output", readonly: true, cols: 60, rows: 5, class: 'form-control') %>
          </div>
          <% if @state.present? and @state != 'error' %>
            <% if ! @packageCheckUpgrade.id.present? %>
              <%= f.submit('Create', class: 'btn btn-primary px-4') %>
            <% else %>
              <%= f.submit('Update', class: 'btn btn-primary px-4') %>
            <% end %>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>
</div>
