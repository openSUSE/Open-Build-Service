#!/usr/bin/perl

use strict;
use warnings;
use Test::More;

plan tests => 3;

`grep -q "function create_sign_cert" /usr/lib/obs/server/setup-appliance.sh`;

SKIP: {
  skip "obs version less then 2.11", 3 if $?;
  for my $file (qw{obs-default-gpg.asc obs-default-gpg.cert}) {
    ok(-f "/srv/obs/$file", "Checking file $file");
  }

  `openssl x509 -text -noout < /srv/obs/obs-default-gpg.cert |grep -q "private OBS"`;
  ok($? == 0, "X509 Certificate for package signing");
}

exit 0;
